{% import "utility.macros.j2" as utility %}


{% macro speaking(author=none, past=false) %}
  {% set range = 'past' if past else 'future' %}
  {% set pages = all_pages|filter_pages('speakers', 'has', author) if author else all_pages %}
  {% set events = pages|collect('events', label_with='slug')|filter_events(past)|sort(reverse=past, attribute='date') %}

  {% if events %}
    <section data-module="events" data-events="{{ range }}">
      {% set title = 'Speaking History' if past else 'Upcoming Talks' %}
      <h2>{{ title }}</h2>

      {{ list(
        events=events
      ) }}
    </section>
  {% endif %}
{% endmacro %}


{% macro list(events) %}
  {% for event in events %}
    {% set event_date = event.date|make_date %}

    <article class="event">
      <time>{{ event_date|format_date('%B %-d, %Y') }}</time>
      {{ utility.link_if(event.venue, event.url) }}
    </article>
  {% endfor %}
{% endmacro %}
