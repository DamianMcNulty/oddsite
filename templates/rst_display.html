{% extends "layout.html" %}

{% import "blog/macros.j2" as blog %}
{% import 'birds/macros.j2' as birds %}

{% block title %}{{ rst.title }}{% endblock %}

{% block body %}
  {%- if not config.hide_title %}
    {{ rst.html_title }}
  {%- endif %}

  {% if ctx.pub_date %}
    <div data-module="rst-meta" class="meta">
      <p class="byline">
        {% if ctx.author %}
        <span class="meta-bit">by</span> {{ birds.get_card(ctx.author, config) }}
        {% endif %}
        <span class="meta-bit">on</span> {{ blog.pubdate(ctx.pub_date) }}
      </p>
      {{ blog.tags(ctx.tags) }}
    </div>
  {% endif %}

  {{ blog.header_image(ctx) }}

  {{ blog.intro(ctx) }}

  {%- for module in config.before -%}
    {% include module.include %}
  {%- endfor -%}

  {% if rst.fragment %}
    <div data-module="rst-body">
      {{ rst.fragment }}
    </div>
  {% endif %}

  {% if ctx.author %}
    <div data-module="rst-author" class="author-summary inverted">
      {{ birds.get_card(ctx.author, config, details=true) }}
    </div>
  {% endif %}

  {%- for module in config.after -%}
    {% include module.include %}
  {%- endfor -%}

  {% if config.comments %}
    {% include "_comments.html.j2" %}
  {% endif %}
{% endblock %}
